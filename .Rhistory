install.packages("cli")
library(mapview)
library(rgee)
library(rgee)
library(googledrive)
#Import SA boundary
boundary <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
library(sf)
#Import SA boundary
boundary <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
#Retrieve bounding box coordinates
boundary
ee_Initialize(email = 'evendene@gwmail.gwu.edu', drive = TRUE)
#Create polygon using bounding box coordinates
polygon <- ee$Geometry$Polygon(list(c(16.45189, -34.83417), c(32.94498, -34.83417), c(32.94498, -22.12503), c(16.45189, -22.12503), c(16.45189, -22.12503)))
#Import SA boundary
boundary <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
#Retrieve bounding box coordinates
boundary
ee_Initialize(email = 'evendene@gwmail.gwu.edu', drive = TRUE)
ee_install()
ee_clean_pyenv()
ee_install()
library(mapview)
library(rgee)
library(googledrive)
library(sf)
#Import SA boundary
boundary <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
#Retrieve bounding box coordinates
boundary
ee_clean_pyenv()
ee_install()
ee_Initialize(email = 'evendene@gwmail.gwu.edu', drive = TRUE)
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2020_11*.tif", full.names = TRUE)
print(fs)
fs
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2020_11.*.tif", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "*2020_11*.tif", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2020_11*.tif$*", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2020_11*.tif", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2019_11*.tif", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2019_11.*\\.tif", full.names = TRUE)
fs
library(raster)
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2019_11.*\\.tif", full.names = TRUE)
l <- lapply(fs, raster)
s <- fs %>% lapply(raster) %>% stack
library(dplyr)
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2019_11.*\\.tif", full.names = TRUE)
s <- fs %>% lapply(raster) %>% stack
S
s
b <-  b <- brick(s)
temp_zmu <- calc(x = b, fun = mean)
length(s)
b <-  b <- brick(s)
b <- brick(s)
temp_zmu <- calc(x = s, fun = mean)
plot(s)
library(sf)
boundary <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
crs(s)
crs(boundary)
crop(x = s[[1]], y = boundary)
test <- crop(x = s[[1]], y = boundary)
plot(test)
boundary <- st_transform(boundary, crs = st_crs(s[[1]]))
plot(boundary)
test <- crop(x = s[[1]], y = boundary)
plot(test)
test <- s %>% lapply(., crop, boundary)
new_s <- crop(s, boundary)
b <- brick(new_s)
plot(b)
plot(new_s)
temp_zmu <- calc(x = s, fun = mean)
temp_zmu <- calc(x = b, fun = mean)
temp_zmu <- calc(x = new_s, fun = mean)
plot(temp_zmu)
monthly_temp <- function(x, y, z, aa){
fs <- dir(x, pattern = y+"_"z+".*\\.tif", full.names = TRUE)
s <- fs %>% lapply(raster) %>% stack
boundary <- st_transform(boundary, crs = st_crs(s[[1]]))
new_s <- crop(s, boundary)
temp_zmu <- calc(x = new_s, fun = mean)
writeRaster(temp_zmu, filename = file.path(x, aa))
}
monthly_temp <- function(x, y, z, aa){
fs <- dir(x, pattern = paste0(y, "_", z, ."*\\.tif"), full.names = TRUE)
s <- fs %>% lapply(raster) %>% stack
boundary <- st_transform(boundary, crs = st_crs(s[[1]]))
new_s <- crop(s, boundary)
temp_zmu <- calc(x = new_s, fun = mean)
writeRaster(temp_zmu, filename = file.path(x, aa))
}
monthly_temp <- function(x, y, aa){
fs <- dir(x, pattern = y, full.names = TRUE)
s <- fs %>% lapply(raster) %>% stack
boundary <- st_transform(boundary, crs = st_crs(s[[1]]))
new_s <- crop(s, boundary)
temp_zmu <- calc(x = new_s, fun = mean)
writeRaster(temp_zmu, filename = file.path(x, aa))
}
monthly_temp <- function(x, y, boundary, aa){
fs <- dir(x, pattern = y, full.names = TRUE)
s <- fs %>% lapply(raster) %>% stack
boundary <- st_transform(boundary, crs = st_crs(s[[1]]))
new_s <- crop(s, boundary)
temp_zmu <- calc(x = new_s, fun = mean)
writeRaster(temp_zmu, filename = file.path(x, aa))
}
SA <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
monthly_temp("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2019_11.*\\.tif", SA, "2019_11_mean_temp.tif")
monthly_temp("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2019_12.*\\.tif", SA, "2019_11_mean_temp.tif")
monthly_temp("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2019_12.*\\.tif", SA, "2019_12_mean_temp.tif")
monthly_temp("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2020_01.*\\.tif", SA, "2020_01_mean_temp.tif")
monthly_temp("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2020_02.*\\.tif", SA, "2020_02_mean_temp.tif")
devtools::build()
devtools::build()
devtools::build()
library(raster)
library(sf)
library(dplyr)
SA <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
crs(boundary)
monthly_temp <- function(x, y, boundary, aa){
fs <- dir(x, pattern = y, full.names = TRUE)
s <- fs %>% lapply(raster) %>% stack
boundary <- st_transform(boundary, crs = st_crs(s[[1]]))
new_s <- crop(s, boundary)
temp_zmu <- calc(x = new_s, fun = mean)
writeRaster(temp_zmu, filename = file.path(x, aa))
}
SouthAfricaDrought::monthly_temp("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2020_03.*\\.tif", SA, "2020_03_mean_temp.tif")
devtools::install()
library(SouthAfricaDrought)
library(raster)
library(sf)
library(dplyr)
SA <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
crs(boundary)
SouthAfricaDrought::monthly_temp("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2020_03.*\\.tif", SA, "2020_03_mean_temp.tif")
SouthAfricaDrought::avg_stack("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2020_03.*\\.tif", SA, "2020_03_mean_temp.tif")
library(SouthAfricaDrought)
library(raster)
library(sf)
library(dplyr)
SA <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
crs(boundary)
SouthAfricaDrought::avg_stack("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2020_03.*\\.tif", SA, "2020_03_mean_temp.tif")
devtools::build()
devtools::install()
library(SouthAfricaDrought)
library(raster)
library(sf)
library(dplyr)
SA <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
crs(boundary)
SouthAfricaDrought::avg_stack("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", "2020_03.*\\.tif", SA, "2020_03_mean_temp.tif")
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "*mean_temp\\.tif", full.names = TRUE)
fs
s <- fs %>% lapply(raster) %>% stack
names(s) <- c(fs[[1]], fs[[2]], fs[[3]], fs[[4]], fs[[5]])
s
names(s) <- c("Nov_2019", "Dec_2019", "Jan_2020", "Feb_2020", "March_2020")
s
plot(s)
names(s) <- c("MeanTemp_Nov_2019", "MeanTemp_Dec_2019", "MeanTemp_Jan_2020", "MeanTemp_Feb_2020", "MeanTemp_March_2020")
s
plot(s)
writeRaster(s, "SA_MODIS_Temp", format="GTiff")
devtools::document()
echo debug.log >> .gitignore $ git rm debug.log rm 'debug.log' $ git commit -m "Start ignoring debug.log"
.gitignore $ git rm debug.log rm 'debug.log' $ git commit -m "Start ignoring debug.log"
echo debug.log >> .gitignore $ git rm --cached debug.log rm 'debug.log' $ git commit -m "Start ignoring debug.log"
git reset --hard origin/master
git reset --hard origin/main
git reset origin/main
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2019_11*\\.tif", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2019_11*.\\.tif", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "*2019_11*\\.tif", full.names = TRUE)
fs
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2019_11.*\\.tif", full.names = TRUE)
fs
s <- fs %>% lapply(raster) %>% stack
library(SouthAfricaDrought)
library(raster)
library(sf)
library(dplyr)
SA <- read_sf(dsn = "C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought/data-raw", layer = "SouthAfrica_Boundary")
crs(boundary)
fs <- dir("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/MODIS_Temp", pattern = "2019_11.*\\.tif", full.names = TRUE)
fs
s <- fs %>% lapply(raster) %>% stack
boundary <- st_transform(boundary, crs = st_crs(s[[1]]))
new_s <- crop(s, boundary)
plot(new_s)
s <- fs %>% lapply(raster) %>% lapply(.*.02) %>% stack
new_s <- crop(s, boundary) %>% .*.02
s <- fs %>% lapply(raster) %>% lapply(s[1:4], function(x){x*.02}) %>% stack
s <- fs %>% lapply(raster) %>% lapply(s[[1:4]], function(x){x*.02}) %>% stack
s <- fs %>% lapply(raster) %>% lapply(s[1:4], function(x){x*.02}) %>% stack
s <- fs %>% lapply(raster) %>% stack %>% .*.02
s <- fs %>% lapply(raster) %>% stack %>% *.02
s <- fs %>% lapply(raster) %>% stack %>% calc(., function(x) x * 0.02)
s <- fs %>% lapply(raster) %>% crop(., boundary)
s <- fs %>% lapply(raster) %>% stack %>% crop(., boundary)
s <- fs %>% lapply(raster) %>% stack
s <- fs %>% lapply(raster) %>% stack
boundary <- st_transform(boundary, crs = st_crs(s[[1]]))
new_s <- crop(s, boundary)
new_s <- crop(s, boundary) %>% calc(., function(x) x * 0.02)
plot(new_s)
new_s <- crop(s, boundary) %>% calc(., function(x) (x * 0.02)-273)
plot(new_s)
temp_zmu <- calc(x = new_s, fun = mean, na.rm = TRUE)
temp_zmu <- calc(x = new_s, fun = mean, na.rm = TRUE)
plot(temp_zmu)
devtools::build()
devtools::install()
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
# setwd("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought")
#Load farmer data
fs <- system.file("inst/extdata/SouthAfrica_Boundary.shp",
package = "SouthAfricaDrought")
boundary <- roads <- st_read(dsn = fs)
boundary <- st_read(dsn = fs)
# setwd("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought")
#Load farmer data
fs <- system.file("extdata/SouthAfrica_Boundary.shp",
package = "SouthAfricaDrought")
boundary <- st_read(dsn = fs)
# setwd("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought")
#Load farmer data
fs <- system.file("extdata/SouthAfrica_Boundary.shp",
package = "SouthAfricaDrought")
boundary <- st_read(dsn = fs)
devtools::load_all()
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
# setwd("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought")
#Load farmer data
boundary <- system.file("extdata/roads.shp", package = "geospaar") %>% st_read()
# setwd("C:/Users/Emily/Documents/Fall_2020/Geospatial_R/SouthAfricaDrought")
#Load farmer data
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read()
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% raster()
weekly_prec
weekly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% raster()
weekly_prec
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% raster()
plot(weekly_prec)
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack()
plot(weekly_prec)
names(weekly_prec) <- c('week1_2019-10-27_2019-11-02',
'week2_2019-11-17_2019-11-23',
'week3_2019-11-24_2019-11-30',
'week4_2019-12-01_2019-12-07',
'week5_2019-12-08_2019-12-14',
'week6_2019-12-15_2019-12-21',
'week7_2019-12-22_2019-12-28',
'week8_2019-12-29_2019-01-05',
'week9_2019-01-06_2019-01-12',
'week10_2019-01-13_2019-01-19',
'week11_2019-01-20_2019-01-26',
'week12_2019-01-27_2019-02-02',
'week13_2019-02-03_2019-02-09',
'week14_2019-02-10_2019-02-16',
'week15_2019-02-17_2019-02-23',
'week16_2019-02-24_2019-03-02',
'week17_2019-03-10_2019-03-16',
'week18_2019-03-17_2019-02-23',
'week19_2019-03-24_2019-03-30',
'week20_2019-03-31_2019-04-06',
'week21_2019-04-07_2019-04-13',
'week22_2019-04-14_2019-04-20',
'week23_2019-02-21_2019-02-27')
plot(weekly_prec)
st_crs(boundary)
#Load South Africa boundary
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = 2052)
boundary
res(weekly_prec)
#Load weekly precipitation values (mm)
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = 2052)
#Load weekly precipitation values (mm)
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
q1 <- calc(weekly_prec, fun=function(x) quantile(x, .1, na.rm=TRUE))
q1
plotq1
plot(q1)
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = 22293)
plot(boundary)
unname(q1)
q1 <- calc(weekly_prec, fun=function(x) quantile(x, c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1), na.rm=TRUE))
plot(q1)
q1
plot(q1)
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = 7490)
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = 2055)
plot(boundary)
#Load weekly precipitation values (mm) and reprojects to Hartebeesthoek94
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
#Rename precipitation layers according to the data range of each image
names(weekly_prec) <- c('week1_2019-10-27_2019-11-02',
'week2_2019-11-17_2019-11-23',
'week3_2019-11-24_2019-11-30',
'week4_2019-12-01_2019-12-07',
'week5_2019-12-08_2019-12-14',
'week6_2019-12-15_2019-12-21',
'week7_2019-12-22_2019-12-28',
'week8_2019-12-29_2019-01-05',
'week9_2019-01-06_2019-01-12',
'week10_2019-01-13_2019-01-19',
'week11_2019-01-20_2019-01-26',
'week12_2019-01-27_2019-02-02',
'week13_2019-02-03_2019-02-09',
'week14_2019-02-10_2019-02-16',
'week15_2019-02-17_2019-02-23',
'week16_2019-02-24_2019-03-02',
'week17_2019-03-10_2019-03-16',
'week18_2019-03-17_2019-02-23',
'week19_2019-03-24_2019-03-30',
'week20_2019-03-31_2019-04-06',
'week21_2019-04-07_2019-04-13',
'week22_2019-04-14_2019-04-20',
'week23_2019-02-21_2019-02-27')
q1 <- calc(weekly_prec, fun=function(x) quantile(x, c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1), na.rm=TRUE))
q1
plot(q1)
plot(q1)
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = 9221)
plot(boundary)
#Load weekly precipitation values (mm) and reprojects to Hartebeesthoek94
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = 22277)
plot(boundary)
afalb <- paste0("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 ", "+y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = afalb)
plot(boundary)
plot(boundary)
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
afalb <- paste0("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 ", "+y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = afalb)
plot(boundary)
#Load weekly precipitation values (mm) and reprojects to Hartebeesthoek94
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
#Rename precipitation layers according to the data range of each image
names(weekly_prec) <- c('week1_2019-10-27_2019-11-02',
'week2_2019-11-17_2019-11-23',
'week3_2019-11-24_2019-11-30',
'week4_2019-12-01_2019-12-07',
'week5_2019-12-08_2019-12-14',
'week6_2019-12-15_2019-12-21',
'week7_2019-12-22_2019-12-28',
'week8_2019-12-29_2019-01-05',
'week9_2019-01-06_2019-01-12',
'week10_2019-01-13_2019-01-19',
'week11_2019-01-20_2019-01-26',
'week12_2019-01-27_2019-02-02',
'week13_2019-02-03_2019-02-09',
'week14_2019-02-10_2019-02-16',
'week15_2019-02-17_2019-02-23',
'week16_2019-02-24_2019-03-02',
'week17_2019-03-10_2019-03-16',
'week18_2019-03-17_2019-02-23',
'week19_2019-03-24_2019-03-30',
'week20_2019-03-31_2019-04-06',
'week21_2019-04-07_2019-04-13',
'week22_2019-04-14_2019-04-20',
'week23_2019-02-21_2019-02-27')
q1 <- calc(weekly_prec, fun=function(x) quantile(x, c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1), na.rm=TRUE))
q1
plot(q1)
plot(q1)
#Load monthly data
monthly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = afalb)
plot(boundary)
#Load monthly data
monthly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
afalb <- paste0("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 ", "+y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = afalb)
plot(boundary)
#Load monthly data
monthly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
#Load weekly precipitation values (mm) and reprojects to Hartebeesthoek94
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
afalb <- paste0("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 ", "+y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = afalb)
library(SouthAfricaDrought)
library(geospaar)
devtools::install()
devtools::load_all()
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
afalb <- paste0("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 ", "+y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = afalb)
plot(boundary)
#Load monthly data
monthly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
#Load monthly data
monthly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% #projectRaster(., crs = crs(boundary))
#Load weekly precipitation values (mm) and reprojects to Hartebeesthoek94
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
#Load monthly data
monthly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% #projectRaster(., crs = crs(boundary))
#Load weekly precipitation values (mm) and reprojects to Hartebeesthoek94
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
#Load monthly data
monthly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack()# %>% #projectRaster(., crs = crs(boundary))
#Load weekly precipitation values (mm) and reprojects to Hartebeesthoek94
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() %>% projectRaster(., crs = crs(boundary))
library(SouthAfricaDrought)
library(geospaar)
library(sf)
library(rgdal)
library(raster)
afalb <- paste0("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 ", "+y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
#Load South Africa boundary and reprojects to Hartebeesthoek94
boundary <- system.file("extdata/SouthAfrica_Boundary.shp", package = "SouthAfricaDrought") %>% st_read() %>% st_transform(x = ., crs = afalb)
plot(boundary)
#Load monthly data
monthly_prec <- system.file("extdata/SA_Chirps_Monthly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack()# %>% #projectRaster(., crs = crs(boundary))
#Load weekly precipitation values (mm) and reprojects to Hartebeesthoek94
weekly_prec <- system.file("extdata/SA_Chirps_Weekly_Mean_Precip.tif", package = "SouthAfricaDrought") %>% stack() #%>% projectRaster(., crs = crs(boundary))
#Rename precipitation layers according to the data range of each image
names(weekly_prec) <- c('week1_2019-10-27_2019-11-02',
'week2_2019-11-17_2019-11-23',
'week3_2019-11-24_2019-11-30',
'week4_2019-12-01_2019-12-07',
'week5_2019-12-08_2019-12-14',
'week6_2019-12-15_2019-12-21',
'week7_2019-12-22_2019-12-28',
'week8_2019-12-29_2019-01-05',
'week9_2019-01-06_2019-01-12',
'week10_2019-01-13_2019-01-19',
'week11_2019-01-20_2019-01-26',
'week12_2019-01-27_2019-02-02',
'week13_2019-02-03_2019-02-09',
'week14_2019-02-10_2019-02-16',
'week15_2019-02-17_2019-02-23',
'week16_2019-02-24_2019-03-02',
'week17_2019-03-10_2019-03-16',
'week18_2019-03-17_2019-02-23',
'week19_2019-03-24_2019-03-30',
'week20_2019-03-31_2019-04-06',
'week21_2019-04-07_2019-04-13',
'week22_2019-04-14_2019-04-20',
'week23_2019-02-21_2019-02-27')
q1 <- calc(weekly_prec, fun=function(x) quantile(x, c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1), na.rm=TRUE))
